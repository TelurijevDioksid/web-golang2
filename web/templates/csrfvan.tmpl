<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>lab2</title>
    <script>
        const submit = () => {
            const chk = document.getElementById("chk").checked
            const sts = document.getElementById("status")

            const url = chk ? "/user/delete/on" : "/user/delete/off"

            const hdrs = new Headers()
            if (chk) {
                hdrs.append("X-CSRF-TOKEN", "{{.Token}}")
            }

            fetch(url, { method: "DELETE", headers: hdrs })
                .then(res => res.json())
                .then(data => { sts.textContent = JSON.stringify(data) })

            sts.innerHTML = "Try to <a href="/user/login">login</a> again"
        }
    </script>
</head>
<style>
    body {
        margin: 0;
        padding: 0;
        height: 100vh;
        width: 100vw;
        background-color: #f0f0f0;
        color: #000000;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    button {
        margin: 0.5rem 0;
        cursor: pointer;
        text-decoration: none;
        border: none;
        border-radius: 0.5rem;
        padding: 0.5rem 1rem;
        background-color: #000000;
        font-size: 1.5rem;
        color: #ffffff;
    }
</style>
<body>
    <h3>CSRF</h3>
    <p>
        Ovo je stranica za testiranje CSRF napada. Točnije stranica simulira napad pomoću skrivene
        forme kakvu bi napadač mogao napraviti. Ideja je da se korisnik prijavi te se time otvara
        sjednica koja sadrži ID prijavljenog korisnika. Nakon toga korisnik posjeti zlonamjernu
        stranicu koja sadrži skrivenu formu koja se automatski šalje (u ovom slučaju klikom na gumb
        Submit). Preglednik šalje sve kolačiće koji pripadaju domeni stranice koju korisnik posjećuje
        pa tako i kolačić koji sadrži ID prijavljenog korisnika. Taj ID se koristi za brisanje korisnika
        iz baze podataka bez da je korisnik toga svjestan. Za korištenje napada potrebno je  .
        Simuliranje napada se vrši tako da se označi checkbox te se klikne na gumb Submit.
    </p>
    <label for="chk">Koristi CSRF</label>
    <input type="checkbox" id="chk" name="prevent" value="false">
    <button onclick="submit()">Submit<button>
    <div id="sts"></div>
</body>
</html>
